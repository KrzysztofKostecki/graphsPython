import random 
import time 
import ciaggraficzny as cg 

class Edge:
	def __init__(self,v1,v2):
		self.v1 = v1
		self.v2 = v2 


def Randomize(Matrix):
	i=0
	ListOfEdges = [] 
	size = len(Matrix)
	for i in xrange(size):
		for j in xrange(i,size):
			if Matrix[i][j] == 1:
				temp = Edge(i,j)
				ListOfEdges.append(temp)
	start = time.clock()
	NumberOfEdges = len(ListOfEdges)
	for i in xrange(100):
		while True:
			FirstPick = random.randint(0,NumberOfEdges-1)
			SecondPick = random.randint(0,NumberOfEdges-1)
			x1 = ListOfEdges[FirstPick].v1
			y1 = ListOfEdges[FirstPick].v2 
			x2 = ListOfEdges[SecondPick].v1
			y2 = ListOfEdges[SecondPick].v2 

			lap = time.clock()
			if (lap - start > 2):
				return Matrix
			if ((x1 != x2) and (x1 != y2) and (y1 != x2) and (y1!= y2) and (Matrix[x1][y2] == 0) and (Matrix[x2][y1] == 0)):
				break 

		Matrix[x1][y1] = 0
		Matrix[y1][x1] = 0
		Matrix[x2][y2] = 0 
		Matrix[y2][x2] = 0

		y1, y2 = y2, y1 

		Matrix[x1][y1] += 1
		Matrix[y1][x1] += 1
		Matrix[x2][y2] += 1 
		Matrix[y2][x2] += 1

	return Matrix 

def WczytajMacierz(sciezka):
	length = 0 
	with open(sciezka,'r') as plik:
		length = 0 
		for line in plik:
			if ('0' or '1') in line:
				length += 1
		plik.seek(0,0)
		Matrix = [[] for x in xrange(length)]
		i = 0 
		while True:
			char = plik.read(1)
			if not char:
				break
			if '0' in char:
				Matrix[i].append(char)
			if '1' in char:
				Matrix[i].append(char)
			if '\n' in char:
				i += 1 
	print 'Wczytano: '
	for i in xrange(length):
		for j in xrange(length):
			Matrix[i][j] = int(Matrix[i][j])
			print Matrix[i][j],
		print ''
	return Matrix
	

def Wczytaj():
	path = str(raw_input('Podaj nazwe pliku/sciezke: '))
	Matrix = WczytajMacierz(path)


	while True:
		ask  = str(raw_input('Przeprowadzic randomizacje? [Y/N]'))
		if ask == 'Y':
			print 'Po randomizacji:'
			NewMatrix = Randomize(Matrix)

			for i in xrange(len(NewMatrix)):
				for j in xrange(len(NewMatrix)):
					print NewMatrix[i][j],
				print ''
			break

		if ask == 'N':
			print 'No Random'
			NewMatrix = []
			break
			

	while True:
		ask  = str(raw_input('Zapisac do nowego pliku? [Y/N]'))
		if ask == 'Y':
			cg.WriteToFile(NewMatrix,'randmacierz.txt')
			break
		if ask == 'N':
			print 'Brak zapisu'
			break
